import buffer from"buffer";import stream from"stream";import util from"util";import crypto from"crypto";function createCommonjsModule(e,r){return e(r={exports:{}},r.exports),r.exports}var _safeBuffer_5_2_1_safeBuffer=createCommonjsModule(function(e,r){var n=buffer.Buffer;function t(e,r){for(var t in e)r[t]=e[t]}function o(e,r,t){return n(e,r,t)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=buffer:(t(buffer,r),r.Buffer=o),o.prototype=Object.create(n.prototype),t(n,o),o.from=function(e,r,t){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,r,t)},o.alloc=function(e,r,t){if("number"!=typeof e)throw new TypeError("Argument must be a number");e=n(e);return void 0!==r?"string"==typeof t?e.fill(r,t):e.fill(r):e.fill(0),e},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return buffer.SlowBuffer(e)}}),Buffer$7=(_safeBuffer_5_2_1_safeBuffer.Buffer,_safeBuffer_5_2_1_safeBuffer.Buffer);function DataStream(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=Buffer$7.alloc(0),this;if("function"==typeof e.pipe)return this.buffer=Buffer$7.alloc(0),e.pipe(this),this;if(e.length||"object"==typeof e)return this.buffer=e,this.writable=!1,process.nextTick(function(){this.emit("end",e),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof e+")")}util.inherits(DataStream,stream),DataStream.prototype.write=function(e){this.buffer=Buffer$7.concat([this.buffer,Buffer$7.from(e)]),this.emit("data",e)},DataStream.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1};var dataStream=DataStream,Buffer$6=buffer.Buffer,SlowBuffer=buffer.SlowBuffer,_bufferEqualConstantTime_1_0_1_bufferEqualConstantTime=bufferEq;function bufferEq(e,r){if(!Buffer$6.isBuffer(e)||!Buffer$6.isBuffer(r))return!1;if(e.length!==r.length)return!1;for(var t=0,n=0;n<e.length;n++)t|=e[n]^r[n];return 0===t}bufferEq.install=function(){Buffer$6.prototype.equal=SlowBuffer.prototype.equal=function(e){return bufferEq(this,e)}};var origBufEqual=Buffer$6.prototype.equal,origSlowBufEqual=SlowBuffer.prototype.equal;function getParamSize(e){return(e/8|0)+(e%8==0?0:1)}bufferEq.restore=function(){Buffer$6.prototype.equal=origBufEqual,SlowBuffer.prototype.equal=origSlowBufEqual};var paramBytesForAlg={ES256:getParamSize(256),ES384:getParamSize(384),ES512:getParamSize(521)};function getParamBytesForAlg(e){var r=paramBytesForAlg[e];if(r)return r;throw new Error('Unknown algorithm "'+e+'"')}var paramBytesForAlg_1=getParamBytesForAlg,Buffer$5=_safeBuffer_5_2_1_safeBuffer.Buffer,MAX_OCTET=128,CLASS_UNIVERSAL=0,PRIMITIVE_BIT=32,TAG_SEQ=16,TAG_INT=2,ENCODED_TAG_SEQ=TAG_SEQ|PRIMITIVE_BIT|CLASS_UNIVERSAL<<6,ENCODED_TAG_INT=TAG_INT|CLASS_UNIVERSAL<<6;function base64Url(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function signatureAsBuffer(e){if(Buffer$5.isBuffer(e))return e;if("string"==typeof e)return Buffer$5.from(e,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function derToJose(e,r){e=signatureAsBuffer(e);var r=paramBytesForAlg_1(r),t=r+1,n=e.length,o=0;if(e[o++]!==ENCODED_TAG_SEQ)throw new Error('Could not find expected "seq"');var i=e[o++];if(i===(1|MAX_OCTET)&&(i=e[o++]),n-o<i)throw new Error('"seq" specified length of "'+i+'", only "'+(n-o)+'" remaining');if(e[o++]!==ENCODED_TAG_INT)throw new Error('Could not find expected "int" for "r"');i=e[o++];if(n-o-2<i)throw new Error('"r" specified length of "'+i+'", only "'+(n-o-2)+'" available');if(t<i)throw new Error('"r" specified length of "'+i+'", max of "'+t+'" is acceptable');var s=o;if(o+=i,e[o++]!==ENCODED_TAG_INT)throw new Error('Could not find expected "int" for "s"');var a=e[o++];if(n-o!==a)throw new Error('"s" specified length of "'+a+'", expected "'+(n-o)+'"');if(t<a)throw new Error('"s" specified length of "'+a+'", max of "'+t+'" is acceptable');t=o;if((o+=a)!==n)throw new Error('Expected to consume entire buffer, but "'+(n-o)+'" bytes remain');for(var u=r-i,c=r-a,f=Buffer$5.allocUnsafe(u+i+c+a),o=0;o<u;++o)f[o]=0;e.copy(f,o,s+Math.max(-u,0),s+i);for(var l=o=r;o<l+c;++o)f[o]=0;return e.copy(f,o,t+Math.max(-c,0),t+a),f=base64Url(f=f.toString("base64"))}function countPadding(e,r,t){for(var n=0;r+n<t&&0===e[r+n];)++n;return e[r+n]>=MAX_OCTET&&--n,n}function joseToDer(e,r){e=signatureAsBuffer(e);var t=paramBytesForAlg_1(r),n=e.length;if(n!==2*t)throw new TypeError('"'+r+'" signatures must be "'+2*t+'" bytes, saw "'+n+'"');var r=countPadding(e,0,t),n=countPadding(e,t,e.length),o=t-r,i=t-n,s=2+o+1+1+i,a=s<MAX_OCTET,u=Buffer$5.allocUnsafe((a?2:3)+s),c=0;return u[c++]=ENCODED_TAG_SEQ,a?u[c++]=s:(u[c++]=1|MAX_OCTET,u[c++]=255&s),u[c++]=ENCODED_TAG_INT,u[c++]=o,r<0?(u[c++]=0,c+=e.copy(u,c,0,t)):c+=e.copy(u,c,r,t),u[c++]=ENCODED_TAG_INT,u[c++]=i,n<0?(u[c++]=0,e.copy(u,c,t)):e.copy(u,c,t+n),u}var ecdsaSigFormatter={derToJose:derToJose,joseToDer:joseToDer},Buffer$4=_safeBuffer_5_2_1_safeBuffer.Buffer,MSG_INVALID_ALGORITHM='"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',MSG_INVALID_SECRET="secret must be a string or buffer",MSG_INVALID_VERIFIER_KEY="key must be a string or a buffer",MSG_INVALID_SIGNER_KEY="key must be a string, a buffer or an object",supportsKeyObjects="function"==typeof crypto.createPublicKey;function checkIsPublicKey(e){if(!Buffer$4.isBuffer(e)&&"string"!=typeof e){if(!supportsKeyObjects)throw typeError(MSG_INVALID_VERIFIER_KEY);if("object"!=typeof e)throw typeError(MSG_INVALID_VERIFIER_KEY);if("string"!=typeof e.type)throw typeError(MSG_INVALID_VERIFIER_KEY);if("string"!=typeof e.asymmetricKeyType)throw typeError(MSG_INVALID_VERIFIER_KEY);if("function"!=typeof e.export)throw typeError(MSG_INVALID_VERIFIER_KEY)}}function checkIsPrivateKey(e){if(!Buffer$4.isBuffer(e)&&"string"!=typeof e&&"object"!=typeof e)throw typeError(MSG_INVALID_SIGNER_KEY)}function checkIsSecretKey(e){if(!Buffer$4.isBuffer(e)){if("string"==typeof e)return e;if(!supportsKeyObjects)throw typeError(MSG_INVALID_SECRET);if("object"!=typeof e)throw typeError(MSG_INVALID_SECRET);if("secret"!==e.type)throw typeError(MSG_INVALID_SECRET);if("function"!=typeof e.export)throw typeError(MSG_INVALID_SECRET)}}function fromBase64(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function toBase64(e){var r=4-(e=e.toString()).length%4;if(4!=r)for(var t=0;t<r;++t)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function typeError(e){var r=[].slice.call(arguments,1),r=util.format.bind(util,e).apply(null,r);return new TypeError(r)}function bufferOrString(e){return Buffer$4.isBuffer(e)||"string"==typeof e}function normalizeInput(e){return e=bufferOrString(e)?e:JSON.stringify(e)}function createHmacSigner(t){return function(e,r){checkIsSecretKey(r),e=normalizeInput(e);r=crypto.createHmac("sha"+t,r);return r.update(e),fromBase64(r.digest("base64"))}}function createHmacVerifier(n){return function(e,r,t){e=createHmacSigner(n)(e,t);return _bufferEqualConstantTime_1_0_1_bufferEqualConstantTime(Buffer$4.from(r),Buffer$4.from(e))}}function createKeySigner(n){return function(e,r){checkIsPrivateKey(r),e=normalizeInput(e);var t=crypto.createSign("RSA-SHA"+n);return t.update(e),fromBase64(t.sign(r,"base64"))}}function createKeyVerifier(o){return function(e,r,t){checkIsPublicKey(t),e=normalizeInput(e),r=toBase64(r);var n=crypto.createVerify("RSA-SHA"+o);return n.update(e),n.verify(t,r,"base64")}}function createPSSKeySigner(n){return function(e,r){checkIsPrivateKey(r),e=normalizeInput(e);var t=crypto.createSign("RSA-SHA"+n);return t.update(e),fromBase64(t.sign({key:r,padding:crypto.constants.RSA_PKCS1_PSS_PADDING,saltLength:crypto.constants.RSA_PSS_SALTLEN_DIGEST},"base64"))}}function createPSSKeyVerifier(o){return function(e,r,t){checkIsPublicKey(t),e=normalizeInput(e),r=toBase64(r);var n=crypto.createVerify("RSA-SHA"+o);return n.update(e),n.verify({key:t,padding:crypto.constants.RSA_PKCS1_PSS_PADDING,saltLength:crypto.constants.RSA_PSS_SALTLEN_DIGEST},r,"base64")}}function createECDSASigner(r){var t=createKeySigner(r);return function(){var e=t.apply(null,arguments);return ecdsaSigFormatter.derToJose(e,"ES"+r)}}function createECDSAVerifer(n){var o=createKeyVerifier(n);return function(e,r,t){return r=ecdsaSigFormatter.joseToDer(r,"ES"+n).toString("base64"),o(e,r,t)}}function createNoneSigner(){return function(){return""}}function createNoneVerifier(){return function(e,r){return""===r}}supportsKeyObjects&&(MSG_INVALID_VERIFIER_KEY+=" or a KeyObject",MSG_INVALID_SECRET+="or a KeyObject");var _jwa_1_4_1_jwa=function(e){var r={hs:createHmacSigner,rs:createKeySigner,ps:createPSSKeySigner,es:createECDSASigner,none:createNoneSigner},t={hs:createHmacVerifier,rs:createKeyVerifier,ps:createPSSKeyVerifier,es:createECDSAVerifer,none:createNoneVerifier},n=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!n)throw typeError(MSG_INVALID_ALGORITHM,e);e=(n[1]||n[3]).toLowerCase(),n=n[2];return{sign:r[e](n),verify:t[e](n)}},Buffer$3=buffer.Buffer,tostring=function(e){return"string"==typeof e?e:"number"==typeof e||Buffer$3.isBuffer(e)?e.toString():JSON.stringify(e)},Buffer$2=_safeBuffer_5_2_1_safeBuffer.Buffer;function base64url(e,r){return Buffer$2.from(e,r).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function jwsSecuredInput(e,r,t){t=t||"utf8";e=base64url(tostring(e),"binary"),r=base64url(tostring(r),t);return util.format("%s.%s",e,r)}function jwsSign(e){var r=e.header,t=e.payload,n=e.secret||e.privateKey,e=e.encoding,o=_jwa_1_4_1_jwa(r.alg),r=jwsSecuredInput(r,t,e),t=o.sign(r,n);return util.format("%s.%s",r,t)}function SignStream(e){var r=e.secret||e.privateKey||e.key,r=new dataStream(r);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=r,this.payload=new dataStream(e.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}util.inherits(SignStream,stream),SignStream.prototype.sign=function(){try{var e=jwsSign({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},SignStream.sign=jwsSign;var signStream=SignStream,Buffer$1=_safeBuffer_5_2_1_safeBuffer.Buffer,JWS_REGEX=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function isObject$3(e){return"[object Object]"===Object.prototype.toString.call(e)}function safeJsonParse(e){if(isObject$3(e))return e;try{return JSON.parse(e)}catch(e){return}}function headerFromJWS(e){e=e.split(".",1)[0];return safeJsonParse(Buffer$1.from(e,"base64").toString("binary"))}function securedInputFromJWS(e){return e.split(".",2).join(".")}function signatureFromJWS(e){return e.split(".")[2]}function payloadFromJWS(e,r){r=r||"utf8";e=e.split(".")[1];return Buffer$1.from(e,"base64").toString(r)}function isValidJws(e){return JWS_REGEX.test(e)&&!!headerFromJWS(e)}function jwsVerify(e,r,t){if(!r)throw(n=new Error("Missing algorithm parameter for jws.verify")).code="MISSING_ALGORITHM",n;var n=signatureFromJWS(e=tostring(e)),e=securedInputFromJWS(e);return _jwa_1_4_1_jwa(r).verify(e,n,t)}function jwsDecode(e,r){if(r=r||{},!isValidJws(e=tostring(e)))return null;var t=headerFromJWS(e);if(!t)return null;var n=payloadFromJWS(e);return{header:t,payload:n="JWT"!==t.typ&&!r.json?n:JSON.parse(n,r.encoding),signature:signatureFromJWS(e)}}function VerifyStream(e){var r=(e=e||{}).secret||e.publicKey||e.key,r=new dataStream(r);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=r,this.signature=new dataStream(e.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}util.inherits(VerifyStream,stream),VerifyStream.prototype.verify=function(){try{var e=jwsVerify(this.signature.buffer,this.algorithm,this.key.buffer),r=jwsDecode(this.signature.buffer,this.encoding);return this.emit("done",e,r),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}},VerifyStream.decode=jwsDecode,VerifyStream.isValid=isValidJws,VerifyStream.verify=jwsVerify;var verifyStream=VerifyStream,ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],ALGORITHMS_1=ALGORITHMS,sign$1=signStream.sign,verify$1=verifyStream.verify,decode$1=verifyStream.decode,isValid=verifyStream.isValid,createSign=function(e){return new signStream(e)},createVerify=function(e){return new verifyStream(e)},_jws_3_2_2_jws={ALGORITHMS:ALGORITHMS_1,sign:sign$1,verify:verify$1,decode:decode$1,isValid:isValid,createSign:createSign,createVerify:createVerify},decode=function(e,r){e=_jws_3_2_2_jws.decode(e,r=r||{});if(!e)return null;var t=e.payload;if("string"==typeof t)try{var n=JSON.parse(t);null!==n&&"object"==typeof n&&(t=n)}catch(e){}return!0===r.complete?{header:e.header,payload:t,signature:e.signature}:t},JsonWebTokenError=function(e,r){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=e,r&&(this.inner=r)},JsonWebTokenError_1=(JsonWebTokenError.prototype=Object.create(Error.prototype),JsonWebTokenError.prototype.constructor=JsonWebTokenError),NotBeforeError=function(e,r){JsonWebTokenError_1.call(this,e),this.name="NotBeforeError",this.date=r},NotBeforeError_1=(NotBeforeError.prototype=Object.create(JsonWebTokenError_1.prototype),NotBeforeError.prototype.constructor=NotBeforeError),TokenExpiredError=function(e,r){JsonWebTokenError_1.call(this,e),this.name="TokenExpiredError",this.expiredAt=r},TokenExpiredError_1=(TokenExpiredError.prototype=Object.create(JsonWebTokenError_1.prototype),TokenExpiredError.prototype.constructor=TokenExpiredError),s=1e3,m=60*s,h=60*m,d=24*h,w=7*d,y=365.25*d,_ms_2_1_3_ms=function(e,r){r=r||{};var t=typeof e;if("string"==t&&0<e.length)return parse(e);if("number"==t&&isFinite(e))return(r.long?fmtLong:fmtShort)(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function parse(e){if(!(100<(e=String(e)).length)){e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(e){var r=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*y;case"weeks":case"week":case"w":return r*w;case"days":case"day":case"d":return r*d;case"hours":case"hour":case"hrs":case"hr":case"h":return r*h;case"minutes":case"minute":case"mins":case"min":case"m":return r*m;case"seconds":case"second":case"secs":case"sec":case"s":return r*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function fmtShort(e){var r=Math.abs(e);return d<=r?Math.round(e/d)+"d":h<=r?Math.round(e/h)+"h":m<=r?Math.round(e/m)+"m":s<=r?Math.round(e/s)+"s":e+"ms"}function fmtLong(e){var r=Math.abs(e);return d<=r?plural(e,r,d,"day"):h<=r?plural(e,r,h,"hour"):m<=r?plural(e,r,m,"minute"):s<=r?plural(e,r,s,"second"):e+" ms"}function plural(e,r,t,n){r=1.5*t<=r;return Math.round(e/t)+" "+n+(r?"s":"")}var timespan=function(e,r){r=r||Math.floor(Date.now()/1e3);if("string"==typeof e){var t=_ms_2_1_3_ms(e);if(void 0!==t)return Math.floor(r+t/1e3)}else if("number"==typeof e)return r+e},semver=createCommonjsModule(function(e,n){n=e.exports=S,c="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},n.SEMVER_SPEC_VERSION="2.0.0";var c,t=256,o=Number.MAX_SAFE_INTEGER||9007199254740991,s=n.re=[],r=n.src=[],e=0,i=(e++,r[0]="0|[1-9]\\d*",e++,r[1]="[0-9]+",e++,r[2]="\\d*[a-zA-Z-][a-zA-Z0-9-]*",e++,r[3]="("+r[0]+")\\.("+r[0]+")\\.("+r[0]+")",e++,r[4]="("+r[1]+")\\.("+r[1]+")\\.("+r[1]+")",e++,r[5]="(?:"+r[0]+"|"+r[2]+")",e++,r[6]="(?:"+r[1]+"|"+r[2]+")",e++,r[7]="(?:-("+r[5]+"(?:\\."+r[5]+")*))",e++,r[8]="(?:-?("+r[6]+"(?:\\."+r[6]+")*))",e++,r[9]="[0-9A-Za-z-]+",e++,r[10]="(?:\\+("+r[9]+"(?:\\."+r[9]+")*))",e++),a="v?"+r[3]+r[7]+"?"+r[10]+"?",u=(r[i]="^"+a+"$","[v=\\s]*"+r[4]+r[8]+"?"+r[10]+"?"),f=e++,l=(r[f]="^"+u+"$",e++,r[13]="((?:<|>)?=?)",e++,r[14]=r[1]+"|x|X|\\*",e++,r[15]=r[0]+"|x|X|\\*",e++,r[16]="[v=\\s]*("+r[15]+")(?:\\.("+r[15]+")(?:\\.("+r[15]+")(?:"+r[7]+")?"+r[10]+"?)?)?",e++,r[17]="[v=\\s]*("+r[14]+")(?:\\.("+r[14]+")(?:\\.("+r[14]+")(?:"+r[8]+")?"+r[10]+"?)?)?",e++),p=(r[l]="^"+r[13]+"\\s*"+r[16]+"$",e++),h=(r[p]="^"+r[13]+"\\s*"+r[17]+"$",e++,r[20]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])",e++,r[21]="(?:~>?)",e++,r[22]="(\\s*)"+r[21]+"\\s+",s[22]=new RegExp(r[22],"g"),e++),m=(r[h]="^"+r[21]+r[16]+"$",e++),d=(r[m]="^"+r[21]+r[17]+"$",e++,r[25]="(?:\\^)",e++,r[26]="(\\s*)"+r[25]+"\\s+",s[26]=new RegExp(r[26],"g"),e++),_=(r[d]="^"+r[25]+r[16]+"$",e++),g=(r[_]="^"+r[25]+r[17]+"$",e++,r[29]="^"+r[13]+"\\s*("+u+")$|^$",e++,r[30]="^"+r[13]+"\\s*("+a+")$|^$",e++,r[31]="(\\s*)"+r[13]+"\\s*("+u+"|"+r[16]+")",s[31]=new RegExp(r[31],"g"),e++,r[32]="^\\s*("+r[16]+")\\s+-\\s+("+r[16]+")\\s*$",e++,r[33]="^\\s*("+r[17]+")\\s+-\\s+("+r[17]+")\\s*$",+e);r[g]="(<|>)?=?\\s*\\*";for(var y=0;y<35;y++)c(y,r[y]),s[y]||(s[y]=new RegExp(r[y]));function b(e,r){if(e instanceof S)return e;if("string"!=typeof e)return null;if(e.length>t)return null;if(!((r=r&&"object"==typeof r?r:{loose:!!r,includePrerelease:!1}).loose?s[f]:s[i]).test(e))return null;try{return new S(e,r)}catch(e){return null}}function S(e,r){if(r&&"object"==typeof r||(r={loose:!!r,includePrerelease:!1}),e instanceof S){if(e.loose===r.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>t)throw new TypeError("version is longer than "+t+" characters");if(!(this instanceof S))return new S(e,r);c("SemVer",e,r),this.options=r,this.loose=!!r.loose;r=e.trim().match(r.loose?s[f]:s[i]);if(!r)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(e){if(/^[0-9]+$/.test(e)){var r=+e;if(0<=r&&r<o)return r}return e}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}n.parse=b,n.valid=function(e,r){e=b(e,r);return e?e.version:null},n.clean=function(e,r){e=b(e.trim().replace(/^[=v]+/,""),r);return e?e.version:null},(n.SemVer=S).prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},S.prototype.toString=function(){return this.version},S.prototype.compare=function(e){return c("SemVer.compare",this.version,this.options,e),e instanceof S||(e=new S(e,this.options)),this.compareMain(e)||this.comparePre(e)},S.prototype.compareMain=function(e){return e instanceof S||(e=new S(e,this.options)),E(this.major,e.major)||E(this.minor,e.minor)||E(this.patch,e.patch)},S.prototype.comparePre=function(e){if(e instanceof S||(e=new S(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var r=0;do{var t=this.prerelease[r],n=e.prerelease[r];if(c("prerelease compare",r,t,n),void 0===t&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===t)return-1;if(t!==n)return E(t,n)}while(++r)},S.prototype.inc=function(e,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r),this.inc("pre",r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",r),this.inc("pre",r);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var t=this.prerelease.length;0<=--t;)"number"==typeof this.prerelease[t]&&(this.prerelease[t]++,t=-2);-1===t&&this.prerelease.push(0)}r&&(this.prerelease[0]!==r||isNaN(this.prerelease[1]))&&(this.prerelease=[r,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},n.inc=function(e,r,t,n){"string"==typeof t&&(n=t,t=void 0);try{return new S(e,t).inc(r,n).version}catch(e){return null}},n.diff=function(e,r){{if(I(e,r))return null;var t,n,o=b(e),i=b(r),s="";for(n in(o.prerelease.length||i.prerelease.length)&&(s="pre",t="prerelease"),o)if(("major"===n||"minor"===n||"patch"===n)&&o[n]!==i[n])return s+n;return t}},n.compareIdentifiers=E;var v=/^[0-9]+$/;function E(e,r){var t=v.test(e),n=v.test(r);return t&&n&&(e=+e,r=+r),e===r?0:t&&!n||(!n||t)&&e<r?-1:1}function w(e,r,t){return new S(e,t).compare(new S(r,t))}function j(e,r,t){return 0<w(e,r,t)}function T(e,r,t){return w(e,r,t)<0}function I(e,r,t){return 0===w(e,r,t)}function V(e,r,t){return 0!==w(e,r,t)}function $(e,r,t){return 0<=w(e,r,t)}function A(e,r,t){return w(e,r,t)<=0}function B(e,r,t,n){switch(r){case"===":return(e="object"==typeof e?e.version:e)===(t="object"==typeof t?t.version:t);case"!==":return(e="object"==typeof e?e.version:e)!==(t="object"==typeof t?t.version:t);case"":case"=":case"==":return I(e,t,n);case"!=":return V(e,t,n);case">":return j(e,t,n);case">=":return $(e,t,n);case"<":return T(e,t,n);case"<=":return A(e,t,n);default:throw new TypeError("Invalid operator: "+r)}}function N(e,r){if(r&&"object"==typeof r||(r={loose:!!r,includePrerelease:!1}),e instanceof N){if(e.loose===!!r.loose)return e;e=e.value}if(!(this instanceof N))return new N(e,r);c("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===k?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}n.rcompareIdentifiers=function(e,r){return E(r,e)},n.major=function(e,r){return new S(e,r).major},n.minor=function(e,r){return new S(e,r).minor},n.patch=function(e,r){return new S(e,r).patch},n.compare=w,n.compareLoose=function(e,r){return w(e,r,!0)},n.rcompare=function(e,r,t){return w(r,e,t)},n.sort=function(e,t){return e.sort(function(e,r){return n.compare(e,r,t)})},n.rsort=function(e,t){return e.sort(function(e,r){return n.rcompare(e,r,t)})},n.gt=j,n.lt=T,n.eq=I,n.neq=V,n.gte=$,n.lte=A,n.cmp=B,n.Comparator=N;var k={};function O(e,r){if(r&&"object"==typeof r||(r={loose:!!r,includePrerelease:!1}),e instanceof O)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new O(e.raw,r);if(e instanceof N)return new O(e.value,r);if(!(this instanceof O))return new O(e,r);if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function P(e){return!e||"x"===e.toLowerCase()||"*"===e}function L(e,r,t,n,o,i,s,a,u,c,f,l,p){return((r=P(t)?"":P(n)?">="+t+".0.0":P(o)?">="+t+"."+n+".0":">="+r)+" "+(a=P(u)?"":P(c)?"<"+(+u+1)+".0.0":P(f)?"<"+u+"."+(+c+1)+".0":l?"<="+u+"."+c+"."+f+"-"+l:"<="+a)).trim()}function x(e,r,t){try{r=new O(r,t)}catch(e){return!1}return r.test(e)}function R(e,r,t,n){var o,i,s,a,u;switch(e=new S(e,n),r=new O(r,n),t){case">":o=j,i=A,s=T,a=">",u=">=";break;case"<":o=T,i=$,s=j,a="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(x(e,r,n))return!1;for(var c=0;c<r.set.length;++c){var f=r.set[c],l=null,p=null;if(f.forEach(function(e){e.semver===k&&(e=new N(">=0.0.0")),l=l||e,p=p||e,o(e.semver,l.semver,n)?l=e:s(e.semver,p.semver,n)&&(p=e)}),l.operator===a||l.operator===u)return!1;if((!p.operator||p.operator===a)&&i(e,p.semver))return!1;if(p.operator===u&&s(e,p.semver))return!1}return!0}N.prototype.parse=function(e){var r=this.options.loose?s[29]:s[30],r=e.match(r);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],"="===this.operator&&(this.operator=""),r[2]?this.semver=new S(r[2],this.options.loose):this.semver=k},N.prototype.toString=function(){return this.value},N.prototype.test=function(e){return c("Comparator.test",e,this.options.loose),this.semver===k||B(e="string"==typeof e?new S(e,this.options):e,this.operator,this.semver,this.options)},N.prototype.intersects=function(e,r){if(!(e instanceof N))throw new TypeError("a Comparator is required");if(r&&"object"==typeof r||(r={loose:!!r,includePrerelease:!1}),""===this.operator)return t=new O(e.value,r),x(this.value,t,r);if(""===e.operator)return t=new O(this.value,r),x(e.semver,t,r);var t=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),n=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),o=this.semver.version===e.semver.version,i=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),s=B(this.semver,"<",e.semver,r)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),r=B(this.semver,">",e.semver,r)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return t||n||o&&i||s||r},(n.Range=O).prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range},O.prototype.toString=function(){return this.range},O.prototype.parseRange=function(e){var r=this.options.loose,t=(e=e.trim(),r?s[33]:s[32]),n=(e=e.replace(t,L),c("hyphen replace",e),e=e.replace(s[31],"$1$2$3"),c("comparator trim",e,s[31]),e=(e=(e=e.replace(s[22],"$1~")).replace(s[26],"$1^")).split(/\s+/).join(" "),r?s[29]:s[30]),t=e.split(" ").map(function(e){return e=e,r=this.options,c("comp",e,r),e=function(e,r){return e.trim().split(/\s+/).map(function(e){var i=e,e=r;return c("caret",i,e),e=e.loose?s[_]:s[d],i.replace(e,function(e,r,t,n,o){return c("caret",i,e,r,t,n,o),e=P(r)?"":P(t)?">="+r+".0.0 <"+(+r+1)+".0.0":P(n)?"0"===r?">="+r+"."+t+".0 <"+r+"."+(+t+1)+".0":">="+r+"."+t+".0 <"+(+r+1)+".0.0":o?(c("replaceCaret pr",o),"0"===r?"0"===t?">="+r+"."+t+"."+n+"-"+o+" <"+r+"."+t+"."+(+n+1):">="+r+"."+t+"."+n+"-"+o+" <"+r+"."+(+t+1)+".0":">="+r+"."+t+"."+n+"-"+o+" <"+(+r+1)+".0.0"):(c("no pr"),"0"===r?"0"===t?">="+r+"."+t+"."+n+" <"+r+"."+t+"."+(+n+1):">="+r+"."+t+"."+n+" <"+r+"."+(+t+1)+".0":">="+r+"."+t+"."+n+" <"+(+r+1)+".0.0"),c("caret return",e),e})}).join(" ")}(e,r),c("caret",e),e=function(e,r){return e.trim().split(/\s+/).map(function(e){var i=e,e=r;return e=r.loose?s[m]:s[h],i.replace(e,function(e,r,t,n,o){return c("tilde",i,e,r,t,n,o),e=P(r)?"":P(t)?">="+r+".0.0 <"+(+r+1)+".0.0":P(n)?">="+r+"."+t+".0 <"+r+"."+(+t+1)+".0":o?(c("replaceTilde pr",o),">="+r+"."+t+"."+n+"-"+o+" <"+r+"."+(+t+1)+".0"):">="+r+"."+t+"."+n+" <"+r+"."+(+t+1)+".0",c("tilde return",e),e})}).join(" ")}(e,r),c("tildes",e),e=function(e,r){return c("replaceXRanges",e,r),e.split(/\s+/).map(function(e){var u=e,e=r;return u=u.trim(),e=e.loose?s[p]:s[l],u.replace(e,function(e,r,t,n,o,i){c("xRange",u,e,r,t,n,o,i);var i=P(t),s=i||P(n),a=s||P(o);return"="===r&&a&&(r=""),i?e=">"===r||"<"===r?"<0.0.0":"*":r&&a?(s&&(n=0),o=0,">"===r?(r=">=",o=s?(t=+t+1,n=0):(n=+n+1,0)):"<="===r&&(r="<",s?t=+t+1:n=+n+1),e=r+t+"."+n+"."+o):s?e=">="+t+".0.0 <"+(+t+1)+".0.0":a&&(e=">="+t+"."+n+".0 <"+t+"."+(+n+1)+".0"),c("xRange return",e),e})}).join(" ")}(e,r),c("xrange",e),e=function(e,r){return c("replaceStars",e,r),e.trim().replace(s[g],"")}(e,r),c("stars",e),e;var r},this).join(" ").split(/\s+/);return t=(t=this.options.loose?t.filter(function(e){return!!e.match(n)}):t).map(function(e){return new N(e,this.options)},this)},O.prototype.intersects=function(t,n){if(t instanceof O)return this.set.some(function(e){return e.every(function(r){return t.set.some(function(e){return e.every(function(e){return r.intersects(e,n)})})})});throw new TypeError("a Range is required")},n.toComparators=function(e,r){return new O(e,r).set.map(function(e){return e.map(function(e){return e.value}).join(" ").trim().split(" ")})},O.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new S(e,this.options));for(var r=0;r<this.set.length;r++)if(function(e,r,t){for(var n=0;n<e.length;n++)if(!e[n].test(r))return;if(!r.prerelease.length||t.includePrerelease)return 1;for(n=0;n<e.length;n++)if(c(e[n].semver),e[n].semver!==k&&0<e[n].semver.prerelease.length){var o=e[n].semver;if(o.major===r.major&&o.minor===r.minor&&o.patch===r.patch)return 1}return}(this.set[r],e,this.options))return!0;return!1},n.satisfies=x,n.maxSatisfying=function(e,r,t){var n=null,o=null;try{var i=new O(r,t)}catch(e){return null}return e.forEach(function(e){!i.test(e)||n&&-1!==o.compare(e)||(o=new S(n=e,t))}),n},n.minSatisfying=function(e,r,t){var n=null,o=null;try{var i=new O(r,t)}catch(e){return null}return e.forEach(function(e){!i.test(e)||n&&1!==o.compare(e)||(o=new S(n=e,t))}),n},n.minVersion=function(e,r){e=new O(e,r);var t=new S("0.0.0");if(e.test(t))return t;if(t=new S("0.0.0-0"),e.test(t))return t;t=null;for(var n=0;n<e.set.length;++n)e.set[n].forEach(function(e){var r=new S(e.semver.version);switch(e.operator){case">":0===r.prerelease.length?r.patch++:r.prerelease.push(0),r.raw=r.format();case"":case">=":t&&!j(t,r)||(t=r);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}});if(t&&e.test(t))return t;return null},n.validRange=function(e,r){try{return new O(e,r).range||"*"}catch(e){return null}},n.ltr=function(e,r,t){return R(e,r,"<",t)},n.gtr=function(e,r,t){return R(e,r,">",t)},n.outside=R,n.prerelease=function(e,r){e=b(e,r);return e&&e.prerelease.length?e.prerelease:null},n.intersects=function(e,r,t){return e=new O(e,t),r=new O(r,t),e.intersects(r)},n.coerce=function(e){if(e instanceof S)return e;if("string"!=typeof e)return null;e=e.match(s[20]);return null!=e?b(e[1]+"."+(e[2]||"0")+"."+(e[3]||"0")):null}}),psSupported=(semver.SEMVER_SPEC_VERSION,semver.re,semver.src,semver.parse,semver.valid,semver.clean,semver.SemVer,semver.inc,semver.diff,semver.compareIdentifiers,semver.rcompareIdentifiers,semver.major,semver.minor,semver.patch,semver.compare,semver.compareLoose,semver.rcompare,semver.sort,semver.rsort,semver.gt,semver.lt,semver.eq,semver.neq,semver.gte,semver.lte,semver.cmp,semver.Comparator,semver.Range,semver.toComparators,semver.satisfies,semver.maxSatisfying,semver.minSatisfying,semver.minVersion,semver.validRange,semver.ltr,semver.gtr,semver.outside,semver.prerelease,semver.intersects,semver.coerce,semver.satisfies(process.version,"^6.12.0 || >=8.0.0")),PUB_KEY_ALGS=["RS256","RS384","RS512","ES256","ES384","ES512"],RSA_KEY_ALGS=["RS256","RS384","RS512"],HS_ALGS=["HS256","HS384","HS512"],verify=(psSupported&&(PUB_KEY_ALGS.splice(3,0,"PS256","PS384","PS512"),RSA_KEY_ALGS.splice(3,0,"PS256","PS384","PS512")),function(o,t,i,e){var s;if("function"!=typeof i||e||(e=i,i={}),i=i||{},i=Object.assign({},i),s=e||function(e,r){if(e)throw e;return r},i.clockTimestamp&&"number"!=typeof i.clockTimestamp)return s(new JsonWebTokenError_1("clockTimestamp must be a number"));if(void 0!==i.nonce&&("string"!=typeof i.nonce||""===i.nonce.trim()))return s(new JsonWebTokenError_1("nonce must be a non-empty string"));var a=i.clockTimestamp||Math.floor(Date.now()/1e3);if(!o)return s(new JsonWebTokenError_1("jwt must be provided"));if("string"!=typeof o)return s(new JsonWebTokenError_1("jwt must be a string"));var u,c=o.split(".");if(3!==c.length)return s(new JsonWebTokenError_1("jwt malformed"));try{u=decode(o,{complete:!0})}catch(e){return s(e)}if(!u)return s(new JsonWebTokenError_1("invalid token"));var r,f=u.header;if("function"==typeof t){if(!e)return s(new JsonWebTokenError_1("verify must be called asynchronous if secret or public key is provided as a callback"));r=t}else r=function(e,r){return r(null,t)};return r(f,function(e,r){if(e)return s(new JsonWebTokenError_1("error in secret or public key callback: "+e.message));e=""!==c[2].trim();if(!e&&r)return s(new JsonWebTokenError_1("jwt signature is required"));if(e&&!r)return s(new JsonWebTokenError_1("secret or public key must be provided"));if(e||i.algorithms||(i.algorithms=["none"]),i.algorithms||(i.algorithms=~r.toString().indexOf("BEGIN CERTIFICATE")||~r.toString().indexOf("BEGIN PUBLIC KEY")?PUB_KEY_ALGS:~r.toString().indexOf("BEGIN RSA PUBLIC KEY")?RSA_KEY_ALGS:HS_ALGS),!~i.algorithms.indexOf(u.header.alg))return s(new JsonWebTokenError_1("invalid algorithm"));try{t=_jws_3_2_2_jws.verify(o,u.header.alg,r)}catch(e){return s(e)}if(!t)return s(new JsonWebTokenError_1("invalid signature"));var t,e=u.payload;if(void 0!==e.nbf&&!i.ignoreNotBefore){if("number"!=typeof e.nbf)return s(new JsonWebTokenError_1("invalid nbf value"));if(e.nbf>a+(i.clockTolerance||0))return s(new NotBeforeError_1("jwt not active",new Date(1e3*e.nbf)))}if(void 0!==e.exp&&!i.ignoreExpiration){if("number"!=typeof e.exp)return s(new JsonWebTokenError_1("invalid exp value"));if(a>=e.exp+(i.clockTolerance||0))return s(new TokenExpiredError_1("jwt expired",new Date(1e3*e.exp)))}if(i.audience){var n=Array.isArray(i.audience)?i.audience:[i.audience];if(!(Array.isArray(e.aud)?e.aud:[e.aud]).some(function(r){return n.some(function(e){return e instanceof RegExp?e.test(r):e===r})}))return s(new JsonWebTokenError_1("jwt audience invalid. expected: "+n.join(" or ")))}if(i.issuer&&("string"==typeof i.issuer&&e.iss!==i.issuer||Array.isArray(i.issuer)&&-1===i.issuer.indexOf(e.iss)))return s(new JsonWebTokenError_1("jwt issuer invalid. expected: "+i.issuer));if(i.subject&&e.sub!==i.subject)return s(new JsonWebTokenError_1("jwt subject invalid. expected: "+i.subject));if(i.jwtid&&e.jti!==i.jwtid)return s(new JsonWebTokenError_1("jwt jwtid invalid. expected: "+i.jwtid));if(i.nonce&&e.nonce!==i.nonce)return s(new JsonWebTokenError_1("jwt nonce invalid. expected: "+i.nonce));if(i.maxAge){if("number"!=typeof e.iat)return s(new JsonWebTokenError_1("iat required when maxAge is specified"));r=timespan(i.maxAge,e.iat);if(void 0===r)return s(new JsonWebTokenError_1('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(a>=r+(i.clockTolerance||0))return s(new TokenExpiredError_1("maxAge exceeded",new Date(1e3*r)))}return!0===i.complete?(t=u.signature,s(null,{header:f,payload:e,signature:t})):s(null,e)})}),INFINITY$2=1/0,MAX_SAFE_INTEGER=9007199254740991,MAX_INTEGER$2=17976931348623157e292,NAN$2=NaN,argsTag="[object Arguments]",funcTag="[object Function]",genTag="[object GeneratorFunction]",stringTag$1="[object String]",symbolTag$2="[object Symbol]",reTrim$2=/^\s+|\s+$/g,reIsBadHex$2=/^[-+]0x[0-9a-f]+$/i,reIsBinary$2=/^0b[01]+$/i,reIsOctal$2=/^0o[0-7]+$/i,reIsUint=/^(?:0|[1-9]\d*)$/,freeParseInt$2=parseInt;function arrayMap(e,r){for(var t=-1,n=e?e.length:0,o=Array(n);++t<n;)o[t]=r(e[t],t,e);return o}function baseFindIndex(e,r,t,n){for(var o=e.length,i=t+(n?1:-1);n?i--:++i<o;)if(r(e[i],i,e))return i;return-1}function baseIndexOf(e,r,t){if(r!=r)return baseFindIndex(e,baseIsNaN,t);for(var n=t-1,o=e.length;++n<o;)if(e[n]===r)return n;return-1}function baseIsNaN(e){return e!=e}function baseTimes(e,r){for(var t=-1,n=Array(e);++t<e;)n[t]=r(t);return n}function baseValues(r,e){return arrayMap(e,function(e){return r[e]})}function overArg$1(r,t){return function(e){return r(t(e))}}var objectProto$6=Object.prototype,hasOwnProperty$1=objectProto$6.hasOwnProperty,objectToString$6=objectProto$6.toString,propertyIsEnumerable=objectProto$6.propertyIsEnumerable,nativeKeys=overArg$1(Object.keys,Object),nativeMax=Math.max;function arrayLikeKeys(e,r){var t,n=isArray$1(e)||isArguments(e)?baseTimes(e.length,String):[],o=n.length,i=!!o;for(t in e)!r&&!hasOwnProperty$1.call(e,t)||i&&("length"==t||isIndex(t,o))||n.push(t);return n}function baseKeys(e){if(!isPrototype(e))return nativeKeys(e);var r,t=[];for(r in Object(e))hasOwnProperty$1.call(e,r)&&"constructor"!=r&&t.push(r);return t}function isIndex(e,r){return!!(r=null==r?MAX_SAFE_INTEGER:r)&&("number"==typeof e||reIsUint.test(e))&&-1<e&&e%1==0&&e<r}function isPrototype(e){var r=e&&e.constructor;return e===("function"==typeof r&&r.prototype||objectProto$6)}function includes(e,r,t,n){e=isArrayLike(e)?e:values(e),t=t&&!n?toInteger$2(t):0;n=e.length;return t<0&&(t=nativeMax(n+t,0)),isString$1(e)?t<=n&&-1<e.indexOf(r,t):!!n&&-1<baseIndexOf(e,r,t)}function isArguments(e){return isArrayLikeObject(e)&&hasOwnProperty$1.call(e,"callee")&&(!propertyIsEnumerable.call(e,"callee")||objectToString$6.call(e)==argsTag)}var isArray$1=Array.isArray;function isArrayLike(e){return null!=e&&isLength(e.length)&&!isFunction(e)}function isArrayLikeObject(e){return isObjectLike$6(e)&&isArrayLike(e)}function isFunction(e){e=isObject$2(e)?objectToString$6.call(e):"";return e==funcTag||e==genTag}function isLength(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=MAX_SAFE_INTEGER}function isObject$2(e){var r=typeof e;return!!e&&("object"==r||"function"==r)}function isObjectLike$6(e){return!!e&&"object"==typeof e}function isString$1(e){return"string"==typeof e||!isArray$1(e)&&isObjectLike$6(e)&&objectToString$6.call(e)==stringTag$1}function isSymbol$2(e){return"symbol"==typeof e||isObjectLike$6(e)&&objectToString$6.call(e)==symbolTag$2}function toFinite$2(e){return e?(e=toNumber$2(e))===INFINITY$2||e===-INFINITY$2?(e<0?-1:1)*MAX_INTEGER$2:e==e?e:0:0===e?e:0}function toInteger$2(e){var e=toFinite$2(e),r=e%1;return e==e?r?e-r:e:0}function toNumber$2(e){if("number"==typeof e)return e;if(isSymbol$2(e))return NAN$2;if("string"!=typeof(e=isObject$2(e)?isObject$2(r="function"==typeof e.valueOf?e.valueOf():e)?r+"":r:e))return 0===e?e:+e;e=e.replace(reTrim$2,"");var r=reIsBinary$2.test(e);return r||reIsOctal$2.test(e)?freeParseInt$2(e.slice(2),r?2:8):reIsBadHex$2.test(e)?NAN$2:+e}function keys(e){return(isArrayLike(e)?arrayLikeKeys:baseKeys)(e)}function values(e){return e?baseValues(e,keys(e)):[]}var _lodash_includes_4_3_0_lodash_includes=includes,boolTag="[object Boolean]",objectProto$5=Object.prototype,objectToString$5=objectProto$5.toString;function isBoolean(e){return!0===e||!1===e||isObjectLike$5(e)&&objectToString$5.call(e)==boolTag}function isObjectLike$5(e){return!!e&&"object"==typeof e}var _lodash_isboolean_3_0_3_lodash_isboolean=isBoolean,INFINITY$1=1/0,MAX_INTEGER$1=17976931348623157e292,NAN$1=NaN,symbolTag$1="[object Symbol]",reTrim$1=/^\s+|\s+$/g,reIsBadHex$1=/^[-+]0x[0-9a-f]+$/i,reIsBinary$1=/^0b[01]+$/i,reIsOctal$1=/^0o[0-7]+$/i,freeParseInt$1=parseInt,objectProto$4=Object.prototype,objectToString$4=objectProto$4.toString;function isInteger(e){return"number"==typeof e&&e==toInteger$1(e)}function isObject$1(e){var r=typeof e;return!!e&&("object"==r||"function"==r)}function isObjectLike$4(e){return!!e&&"object"==typeof e}function isSymbol$1(e){return"symbol"==typeof e||isObjectLike$4(e)&&objectToString$4.call(e)==symbolTag$1}function toFinite$1(e){return e?(e=toNumber$1(e))===INFINITY$1||e===-INFINITY$1?(e<0?-1:1)*MAX_INTEGER$1:e==e?e:0:0===e?e:0}function toInteger$1(e){var e=toFinite$1(e),r=e%1;return e==e?r?e-r:e:0}function toNumber$1(e){if("number"==typeof e)return e;if(isSymbol$1(e))return NAN$1;if("string"!=typeof(e=isObject$1(e)?isObject$1(r="function"==typeof e.valueOf?e.valueOf():e)?r+"":r:e))return 0===e?e:+e;e=e.replace(reTrim$1,"");var r=reIsBinary$1.test(e);return r||reIsOctal$1.test(e)?freeParseInt$1(e.slice(2),r?2:8):reIsBadHex$1.test(e)?NAN$1:+e}var _lodash_isinteger_4_0_4_lodash_isinteger=isInteger,numberTag="[object Number]",objectProto$3=Object.prototype,objectToString$3=objectProto$3.toString;function isObjectLike$3(e){return!!e&&"object"==typeof e}function isNumber(e){return"number"==typeof e||isObjectLike$3(e)&&objectToString$3.call(e)==numberTag}var _lodash_isnumber_3_0_3_lodash_isnumber=isNumber,objectTag="[object Object]";function isHostObject(e){var r=!1;if(null!=e&&"function"!=typeof e.toString)try{r=!!(e+"")}catch(e){}return r}function overArg(r,t){return function(e){return r(t(e))}}var funcProto=Function.prototype,objectProto$2=Object.prototype,funcToString=funcProto.toString,hasOwnProperty=objectProto$2.hasOwnProperty,objectCtorString=funcToString.call(Object),objectToString$2=objectProto$2.toString,getPrototype=overArg(Object.getPrototypeOf,Object);function isObjectLike$2(e){return!!e&&"object"==typeof e}function isPlainObject(e){if(!isObjectLike$2(e)||objectToString$2.call(e)!=objectTag||isHostObject(e))return!1;e=getPrototype(e);if(null===e)return!0;e=hasOwnProperty.call(e,"constructor")&&e.constructor;return"function"==typeof e&&e instanceof e&&funcToString.call(e)==objectCtorString}var _lodash_isplainobject_4_0_6_lodash_isplainobject=isPlainObject,stringTag="[object String]",objectProto$1=Object.prototype,objectToString$1=objectProto$1.toString,isArray=Array.isArray;function isObjectLike$1(e){return!!e&&"object"==typeof e}function isString(e){return"string"==typeof e||!isArray(e)&&isObjectLike$1(e)&&objectToString$1.call(e)==stringTag}var _lodash_isstring_4_0_1_lodash_isstring=isString,FUNC_ERROR_TEXT="Expected a function",INFINITY=1/0,MAX_INTEGER=17976931348623157e292,NAN=NaN,symbolTag="[object Symbol]",reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt,objectProto=Object.prototype,objectToString=objectProto.toString;function before(e,r){var t;if("function"!=typeof r)throw new TypeError(FUNC_ERROR_TEXT);return e=toInteger(e),function(){return 0<--e&&(t=r.apply(this,arguments)),e<=1&&(r=void 0),t}}function once$1(e){return before(2,e)}function isObject(e){var r=typeof e;return!!e&&("object"==r||"function"==r)}function isObjectLike(e){return!!e&&"object"==typeof e}function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&objectToString.call(e)==symbolTag}function toFinite(e){return e?(e=toNumber(e))===INFINITY||e===-INFINITY?(e<0?-1:1)*MAX_INTEGER:e==e?e:0:0===e?e:0}function toInteger(e){var e=toFinite(e),r=e%1;return e==e?r?e-r:e:0}function toNumber(e){if("number"==typeof e)return e;if(isSymbol(e))return NAN;if("string"!=typeof(e=isObject(e)?isObject(r="function"==typeof e.valueOf?e.valueOf():e)?r+"":r:e))return 0===e?e:+e;e=e.replace(reTrim,"");var r=reIsBinary.test(e);return r||reIsOctal.test(e)?freeParseInt(e.slice(2),r?2:8):reIsBadHex.test(e)?NAN:+e}var _lodash_once_4_1_1_lodash_once=once$1,SUPPORTED_ALGS=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"],sign_options_schema=(psSupported&&SUPPORTED_ALGS.splice(3,0,"PS256","PS384","PS512"),{expiresIn:{isValid:function(e){return _lodash_isinteger_4_0_4_lodash_isinteger(e)||_lodash_isstring_4_0_1_lodash_isstring(e)&&e},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(e){return _lodash_isinteger_4_0_4_lodash_isinteger(e)||_lodash_isstring_4_0_1_lodash_isstring(e)&&e},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(e){return _lodash_isstring_4_0_1_lodash_isstring(e)||Array.isArray(e)},message:'"audience" must be a string or array'},algorithm:{isValid:_lodash_includes_4_3_0_lodash_includes.bind(null,SUPPORTED_ALGS),message:'"algorithm" must be a valid string enum value'},header:{isValid:_lodash_isplainobject_4_0_6_lodash_isplainobject,message:'"header" must be an object'},encoding:{isValid:_lodash_isstring_4_0_1_lodash_isstring,message:'"encoding" must be a string'},issuer:{isValid:_lodash_isstring_4_0_1_lodash_isstring,message:'"issuer" must be a string'},subject:{isValid:_lodash_isstring_4_0_1_lodash_isstring,message:'"subject" must be a string'},jwtid:{isValid:_lodash_isstring_4_0_1_lodash_isstring,message:'"jwtid" must be a string'},noTimestamp:{isValid:_lodash_isboolean_3_0_3_lodash_isboolean,message:'"noTimestamp" must be a boolean'},keyid:{isValid:_lodash_isstring_4_0_1_lodash_isstring,message:'"keyid" must be a string'},mutatePayload:{isValid:_lodash_isboolean_3_0_3_lodash_isboolean,message:'"mutatePayload" must be a boolean'}}),registered_claims_schema={iat:{isValid:_lodash_isnumber_3_0_3_lodash_isnumber,message:'"iat" should be a number of seconds'},exp:{isValid:_lodash_isnumber_3_0_3_lodash_isnumber,message:'"exp" should be a number of seconds'},nbf:{isValid:_lodash_isnumber_3_0_3_lodash_isnumber,message:'"nbf" should be a number of seconds'}};function validate(t,n,o,i){if(!_lodash_isplainobject_4_0_6_lodash_isplainobject(o))throw new Error('Expected "'+i+'" to be a plain object.');Object.keys(o).forEach(function(e){var r=t[e];if(!r){if(n)return;throw new Error('"'+e+'" is not allowed in "'+i+'"')}if(!r.isValid(o[e]))throw new Error(r.message)})}function validateOptions(e){return validate(sign_options_schema,!1,e,"options")}function validatePayload(e){return validate(registered_claims_schema,!0,e,"payload")}var options_to_payload={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},options_for_objects=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"],sign=function(t,e,n,r){n="function"==typeof n?(r=n,{}):n||{};var o="object"==typeof t&&!Buffer.isBuffer(t),i=Object.assign({alg:n.algorithm||"HS256",typ:o?"JWT":void 0,kid:n.keyid},n.header);function s(e){if(r)return r(e);throw e}if(!e&&"none"!==n.algorithm)return s(new Error("secretOrPrivateKey must have a value"));if(void 0===t)return s(new Error("payload is required"));if(o){try{validatePayload(t)}catch(e){return s(e)}n.mutatePayload||(t=Object.assign({},t))}else{var a=options_for_objects.filter(function(e){return void 0!==n[e]});if(0<a.length)return s(new Error("invalid "+a.join(",")+" option for "+typeof t+" payload"))}if(void 0!==t.exp&&void 0!==n.expiresIn)return s(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(void 0!==t.nbf&&void 0!==n.notBefore)return s(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{validateOptions(n)}catch(e){return s(e)}a=t.iat||Math.floor(Date.now()/1e3);if(n.noTimestamp?delete t.iat:o&&(t.iat=a),void 0!==n.notBefore){try{t.nbf=timespan(n.notBefore,a)}catch(e){return s(e)}if(void 0===t.nbf)return s(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(void 0!==n.expiresIn&&"object"==typeof t){try{t.exp=timespan(n.expiresIn,a)}catch(e){return s(e)}if(void 0===t.exp)return s(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(options_to_payload).forEach(function(e){var r=options_to_payload[e];if(void 0!==n[e]){if(void 0!==t[r])return s(new Error('Bad "options.'+e+'" option. The payload already has an "'+r+'" property.'));t[r]=n[e]}});o=n.encoding||"utf8";if("function"!=typeof r)return _jws_3_2_2_jws.sign({header:i,payload:t,secret:e,encoding:o});r=r&&_lodash_once_4_1_1_lodash_once(r),_jws_3_2_2_jws.createSign({header:i,privateKey:e,payload:t,encoding:o}).once("error",r).once("done",function(e){r(null,e)})},_jsonwebtoken_8_5_1_jsonwebtoken={decode:decode,verify:verify,sign:sign,JsonWebTokenError:JsonWebTokenError_1,NotBeforeError:NotBeforeError_1,TokenExpiredError:TokenExpiredError_1};const Setting={expiresIn:"1h"};function getToken({payload:e,key:r,jwtSetting:t}){return _jsonwebtoken_8_5_1_jsonwebtoken.sign(e,r,{...Setting,...t})}function getJWTPayload({token:e,key:r}){try{return _jsonwebtoken_8_5_1_jsonwebtoken.verify(e,r)}catch(e){return null}}var jwt={getToken:getToken,getJWTPayload:getJWTPayload};const parseJson=e=>{try{return JSON.parse(e)}catch(e){return null}},getJsonKey=({key:e,json:r})=>{r=parseJson(r);return r?r[e]:null};var json={parseJson:parseJson,getJsonKey:getJsonKey};function once(r){let t;return function(e){t||(t=!0,r(e))}}var index={jwt:jwt,json:json,once:once};export{index as default};
